dependencies:
  cache_directories:
    - "~/k6-bin"
  post:
    - mkdir -p ~/k6-bin
    - |
      if [[ ! -f ~/k6-bin/k6 ]]; then
        VERSION=0.18.0
        curl -sL https://github.com/loadimpact/k6/releases/download/v${VERSION}/k6-v${VERSION}-linux64.tar.gz | tar xz --strip-components 1 -C ~/k6-bin 
      fi

test:
  override:
    - ~/k6-bin/k6 run -q -o cloud loadtests/main.js
